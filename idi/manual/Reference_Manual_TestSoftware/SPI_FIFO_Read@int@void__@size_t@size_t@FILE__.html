<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>SPI_FIFO_Read Function</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx(&#39;frames.html&#39;, &#39;topic&#39;, &#39;SPI_FIFO_Read@int@void__@size_t@size_t@FILE__.html&#39;);" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<em>You are here:</em> <a href="C_Test_Code_-_DOS.html" target="topic">C Test Code - DOS</a> &gt; Symbol Reference &gt; <a href="!!FUNCTIONS.html" target="topic">Functions</a> &gt; <a href="SPI_FIFO_Read@int@void__@size_t@size_t@FILE__.html" target="topic">SPI_FIFO_Read Function</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="33%">
<div class="Element1">
STD-Bus Test Software Reference Manual</div>
</td><td width="34%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_darkblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, &#39;btn_globals_contents_darkblue_hover.gif&#39;);" onmouseout="switchImage(this, &#39;btn_globals_contents_darkblue.gif&#39;);" /></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_darkblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, &#39;btn_globals_index_darkblue_hover.gif&#39;);" onmouseout="switchImage(this, &#39;btn_globals_index_darkblue.gif&#39;);" /></a><a href="index.html" target="topic"><img src="btn_globals_home_darkblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, &#39;btn_globals_home_darkblue_hover.gif&#39;);" onmouseout="switchImage(this, &#39;btn_globals_home_darkblue.gif&#39;);" /></a></div>
</td><td width="33%">
<div class="Element90">
<a href="SPI_Data_Write_Read_Helper_Write@int@size_t@size_t@SPI_CSB_ENUM@BOOL@BOOL@BOOL__@size_t__@void__.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, &#39;btn_prev_midblue_hover.gif&#39;);" onmouseout="switchImage(this, &#39;btn_prev_midblue.gif&#39;);" /></a><a href="!!FUNCTIONS.html" target="topic"><img src="btn_up_midblue.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, &#39;btn_up_midblue_hover.gif&#39;);" onmouseout="switchImage(this, &#39;btn_up_midblue.gif&#39;);" /></a><a href="SPI_FIFO_Write@int@void__@size_t@size_t@FILE__.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, &#39;btn_next_midblue_hover.gif&#39;);" onmouseout="switchImage(this, &#39;btn_next_midblue.gif&#39;);" /></a></div>
</td></tr></table><div class="Element5">
SPI_FIFO_Read Function</div>
<div class="Element7">
<a href="idi_c.html" target="topic">idi.c</a> | <a href="!!FUNCTIONS.html" target="topic">Functions</a> | <a href="!!NAVID_SPI_FIFO_Read@int@void__@size_t@size_t@FILE___ST(16)_SEC_Body_Source.html" target="topic">Body Source</a></div>
<div class="Element731">
<div class="Element730">
<a onclick="ToggleAllElements(&#39;46696C65,52657475726E73,4465736372697074696F6E,426F647920536F75726365,47726F7570,4C696E6B73&#39;, &#39;linkToggleAllElements&#39;, &#39;imgToggleAllElements&#39;, &#39;Collapse All&#39;, &#39;Expand All&#39;);"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements" /></a><a id="linkToggleAllElements" onclick="ToggleAllElements(&#39;46696C65,52657475726E73,4465736372697074696F6E,426F647920536F75726365,47726F7570,4C696E6B73&#39;, &#39;linkToggleAllElements&#39;, &#39;imgToggleAllElements&#39;, &#39;Collapse All&#39;, &#39;Expand All&#39;);">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="432B2B"></a><div class="Element99">
C++</div>
<div class="Element101"><div class="Element100"><pre class="Element100"><strong><span style="color: #008000;">int</span></strong> <strong><span style="color: #660000;">SPI_FIFO_Read</span></strong>(<strong><span style="color: #008000;">int</span></strong> <strong><span style="color: #800080;">board_id</span></strong>, <strong><span style="color: #008000;">const</span></strong> <strong><span style="color: #008000;">void</span></strong> * <strong><span style="color: #800080;">buffer</span></strong>, size_t <strong><span style="color: #800080;">size</span></strong>, size_t <strong><span style="color: #800080;">count</span></strong>, FILE * <strong><span style="color: #800080;">fd_log</span></strong>);</pre></div></div>
<a name="46696C65"></a><div class="Element14">
<a onclick="toggleVisibilityStored(&#39;46696C65&#39;);" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="img46696C65" />File</a></div>
<div id="div46696C65">
<div class="Element11">
<div class="Element10">
<p class="Element10">
<a href="idi_c.html" target="topic">idi.c</a></p></div>
</div>
</div>
<a name="52657475726E73"></a><div class="Element14">
<a onclick="toggleVisibilityStored(&#39;52657475726E73&#39;);" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="img52657475726E73" />Returns</a></div>
<div id="div52657475726E73">
<div class="Element11">
<div class="Element10">
<p class="Element10">
A zero (SUCCESS) is returned if successful, otherwise a negative error code is returned indicating an error. In addition, a positive value is returned indicating the number of actual objects written.</p></div>
</div>
</div>
<a name="4465736372697074696F6E"></a><div class="Element14">
<a onclick="toggleVisibilityStored(&#39;4465736372697074696F6E&#39;);" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="img4465736372697074696F6E" />Description</a></div>
<div id="div4465736372697074696F6E">
<div class="Element11">
<div class="Element10">
<p class="Element10">
brief Reads from the SPI receive/read data FIFO. It does not attempt to correlate the number of transmit bytes with receive bytes. Its purpose is more for low level hardware testing. Note that this function has a signature identical to the fread() function (i.e. make use of function pointers to guide sourcing of data).&#160;</p>
<p class="Element10">
param[in] buffer Buffer for the data destination. param[in] size Size of objects in bytes. param[in] count Number of objects to be read param[out] fd_log Optional log file to write the buffer too. If NULL, then no logging. </p></div>
</div>
</div>
<a name="426F647920536F75726365"></a><div class="Element14">
<a onclick="toggleVisibilityStored(&#39;426F647920536F75726365&#39;);" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="img426F647920536F75726365" />Body Source</a></div>
<div id="div426F647920536F75726365">
<div class="Element11">
<div class="Element10">
<div class="Element170">
<a href="#" onclick="CopyElementToClipboard(&#39;code00244&#39;);">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00244"><pre class="Element12"> 1: <strong><span style="color: #008000;">int</span></strong> SPI_FIFO_Read( <strong><span style="color: #008000;">int</span></strong> board_id, <strong><span style="color: #008000;">const</span></strong> <strong><span style="color: #008000;">void</span></strong> * buffer, size_t size, size_t count, FILE * fd_log )
 2: {
 3: 	<strong><span style="color: #008000;">int</span></strong> 	error_code;       
 4: 	size_t	bytes_available;
 5: 	<a href="BOOL.html" target="topic">BOOL</a>	empty;
 6: 	size_t  index;
 7: 	size_t  qty_objects;
 8: 	size_t 	qty_bytes;
 9: 	<strong><span style="color: #008000;">int</span></strong>		reg_symbol;
10: 
11: <strong><span style="color: #008000;">#define</span></strong> FUNCTION_NAME__  &quot;SPI_FIFO_Read&quot;
12: <strong><span style="color: #008000;">#if</span></strong> ( <a href="IO_TRACE_USE_SPI_LOGGING.html" target="topic">IO_TRACE_USE_SPI_LOGGING</a> == 1 )
13: 	<a href="IO_Trace_Log_Function@char__@size_t@enum_IO_TRACE_ENUM@int@int.html" target="topic">IO_Trace_Log_Function</a>( FUNCTION_NAME__, __LINE__, IO_TRACE_SPI, board_id, 0 );
14: <strong><span style="color: #008000;">#endif</span></strong>
15: <strong><span style="color: #008000;">#undef</span></strong> FUNCTION_NAME__
16: 
17: 	error_code = SUCCESS;
18: 
19: 	<strong><span style="color: #008000;">if</span></strong> ( (size * count) &gt; SPI_FIFO_SIZE ) <strong><span style="color: #008000;">return</span></strong> -EC_PARAMETER;
20: 
21: 	<strong><span style="color: #008000;">if</span></strong> ( <a href="SPI_IsNotPresent@int.html" target="topic">SPI_IsNotPresent</a>( board_id ) ) <strong><span style="color: #008000;">return</span></strong> -EC_SPI_NOT_FOUND;
22: 
23: 	<a href="SPI_Status_Read_FIFO_Status@int@BOOL__@size_t__.html" target="topic">SPI_Status_Read_FIFO_Status</a>( board_id, &amp;empty, &amp;bytes_available );
24: 
25: 	qty_objects =  bytes_available / size; 
26: 	<strong><span style="color: #008000;">if</span></strong> ( count &lt; qty_objects ) qty_objects = count;
27: 
28: 	qty_bytes = qty_objects * size;
29: 
30: 	<strong><span style="color: #008000;">switch</span></strong> ( board_id )
31: 	{
32: 		<strong><span style="color: #008000;">case</span></strong> ID_IDI48:	reg_symbol = (<strong><span style="color: #008000;">int</span></strong>) IDI_SPI_DATA;	<strong><span style="color: #008000;">break</span></strong>;
33: 		<strong><span style="color: #008000;">case</span></strong> ID_IDO48:	reg_symbol = (<strong><span style="color: #008000;">int</span></strong>) IDO_SPI_DATA;	<strong><span style="color: #008000;">break</span></strong>;
34: 	}
35: 	<strong><span style="color: #008000;">for</span></strong> ( index = 0; index &lt; qty_bytes; index++ ) <a href="IO_Read_U8@int@size_t@int@uint8_t__.html" target="topic">IO_Read_U8</a>( board_id, __LINE__, reg_symbol, &amp;(((<a href="uint8_t.html" target="topic">uint8_t</a> *) buffer)[index]) );
36: 
37: 	<strong><span style="color: #008000;">if</span></strong> ( NULL != fd_log )
38: 	{
39: 		error_code = fwrite( buffer, size, qty_objects, fd_log );
40: 	}
41: 
42: 	<strong><span style="color: #008000;">if</span></strong> ( SUCCESS == error_code ) error_code = ( (<strong><span style="color: #008000;">int</span></strong>) qty_objects );
43: 	<strong><span style="color: #008000;">return</span></strong> error_code;
44: }
</pre></div></div>
</div>
</div>
</div>
<a name="47726F7570"></a><div class="Element14">
<a onclick="toggleVisibilityStored(&#39;47726F7570&#39;);" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="img47726F7570" />Group</a></div>
<div id="div47726F7570">
<div class="Element11">
<div class="Element10">
<p class="Element10">
<a href="!!FUNCTIONS.html" target="topic">Functions</a></p></div>
</div>
</div>
<a name="4C696E6B73"></a><div class="Element14">
<a onclick="toggleVisibilityStored(&#39;4C696E6B73&#39;);" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="img4C696E6B73" />Links</a></div>
<div id="div4C696E6B73">
<div class="Element11">
<div class="Element10">
<a href="idi_c.html" target="topic">idi.c</a>, <a href="!!FUNCTIONS.html" target="topic">Functions</a>, <a href="!!NAVID_SPI_FIFO_Read@int@void__@size_t@size_t@FILE___ST(16)_SEC_Body_Source.html" target="topic">Body Source</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 2015 by Apex Embedded Systems.  All rights reserved.   Updated on Tuesday, September 01, 2015.</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.html" target="tocidx">Contents</a> | <a href="idx.html" target="tocidx">Index</a> | <a href="index.html" target="topic">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
What do you think about this topic? <a href="#" onclick="sendFeedback('customer.service@apexembeddedsytems.com', 'STX104 Documentation Feedback', 'Project: STD-Bus Test Software Reference Manual%0ATopic ID: SPI_FIFO_Read@int@void *@size_t@size_t@FILE *%0ATitle: SPI_FIFO_Read Function');"> Send feedback! </a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>